---
import Header from "../components/header.astro";
import Footer from "../components/footer.astro";
---

<!doctype html>
<html lang="en">
  <head>
    <!-- Google Tag Manager -->
    <script is:inline>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-567P2C87");
    </script>
    <!-- End Google Tag Manager -->
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <title>The Serious Sandwich</title>
    <meta name="generator" content={Astro.generator} />
    <link rel="stylesheet" href="/general.css" />
    <link rel="stylesheet" href="/home.css" />
    <link rel="stylesheet" href="/navigation.css" />
    <link rel="stylesheet" href="/contact.css" />
    <link rel="stylesheet" href="/about.css" />
    <link rel="stylesheet" href="/tsandcs.css" />
    <link rel="icon" href="/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=League+Gothic&family=Zalando+Sans:ital,wght@0,200..900;1,200..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      rel="preload"
      as="image"
      href="/images/hero-img-1600.webp"
      imagesrcset="/images/hero-img-600.webp 600w, /images/hero-img-1024.webp 1024w, /images/hero-img-1600.webp 1600w, /images/hero-img-2200.webp 2200w"
      imagesizes="100vw"
      fetchpriority="high"
    />
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-567P2C87"
        height="0"
        width="0"
        style="display:none;visibility:hidden"></iframe></noscript
    >
    <!-- End Google Tag Manager (noscript) -->
    <Header />
    <slot />
    <Footer />
  </body>

  <script src="https://www.fbgcdn.com/embedder/js/ewm2.js" defer async></script>

  <script is:inline>
    if (typeof window !== "undefined") {
      document.addEventListener("click", (e) => {
        const el = e.target.closest("[data-track-click]");
        if (!el || !window.dataLayer) return;

        const name = el.dataset.trackName || el.innerText.trim();

        const dataset = {};
        Object.keys(el.dataset).forEach((key) => {
          if (key !== "trackName") dataset[key] = el.dataset[key];
        });

        window.dataLayer.push({
          event: "button_click",
          button_name: name,
          button_id: el.id || undefined,
          button_class: el.className || undefined,
          page_path: window.location.pathname,
          ...dataset,
        });

        if (el.tagName === "A" && el.href && !el.target) {
          e.preventDefault();
          setTimeout(() => {
            window.location.href = el.href;
          }, 50);
        }
      });
    }
  </script>

  <!-- Splide CDN -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css"
  />
  <script
    src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"
  ></script>
  <script>
    declare const Splide: any;
    document.addEventListener("DOMContentLoaded", function () {
      new Splide("#food-slider", {
        type: "loop",
        gap: "1rem",
        arrows: true,
        pagination: false,
        autoplay: false,
        perPage: 3,
        breakpoints: {
          1024: { perPage: 2 },
          640: { perPage: 1 },
        },
      }).mount();
    });
  </script>
</html>
